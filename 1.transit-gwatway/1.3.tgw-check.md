---
description: 'Update : 2020-02-24'
---

# 1.3 TGW 구성

### TGW Cloudformation 배포

[1.2 TGW를 위한 VPC 구성](1.2.tgw-vpc.md) 에서 처럼 사전에 구성된 Cloudformation으로 배포합니다. Cloudformation 파일은 "1.OCTANK\_TGW.yml"을 선택합니다.

![](../.gitbook/assets/cf_tgw.png)

Stack Name을 선언하고, Stack을 생성합니다.

![](../.gitbook/assets/cf_tgw2.png)

transit gateway는 Hyperplane 기반으로 생성되므로 , 3분 정도의 시간 소요됩니다.  
해당 랩에서는 앞서 생성된 VPC들과 자동으로 연계하도록 구성되어 있습니다.  
Cloudformation이 정상적으로 구성되면 A,B,C,IT OCTANK가 자동으로 연결 구성됩니다.

{% hint style="info" %}
TGW cloudformation에는 Transit Gateway Attachment 와 Transit Gateway Route Table 등이 자동으로 생성됩니다.
{% endhint %}

Cloudformation을 통해 정상적으로 배포가 되었다면, 아래와 같이 VPC Transit Gateway 메뉴에서 Transit Gateway 와 Transit Gateway Attachments, Route Table이 생성됩니다.

![](../.gitbook/assets/transitgateway_check.png)

Transit Gateway Attachment는 아래와 같이 구성이 됩니다.  
앞서 4개의 VPC를 생성했고, 4개의 VPC에 대해 Attachment를 생성한 결과입니다.

![](../.gitbook/assets/transitgateway_check2.png)

Cloudformation으로 구성하지 않았다면 아래와 같이 수동으로 설정하게 됩니다.  
이 랩에서는 이러한 수동설정을 요구하지 않습니다.

![](../.gitbook/assets/transitgateway_check3.png)

{% hint style="info" %}
TGW와 연결할 수 있는 방식은 3가지로 제공되며, 해당 랩에서는 모든 방법이 제공됩니다. VPC 연결방식과 VGW-CGW VPN 연결방식, 다른 TGW와의 연결 방식등이 제공됩니다.
{% endhint %}

Transit Gateway Route Table에서 연결된 VPC들에 대한 라우팅 구성을 확인합니다.

![](../.gitbook/assets/tgw_route_table1.png)

랩에서는 Red, Green, Blue Route Table을 구성했습니다.  
각 Route Table은 앞서 살펴본 Transit Gateway Attachment를 여러개 설정할 수 있으며, 또한 라우팅 테이블을 전파할 것인지, Static Route, Blackhole Route를 처리할 것인지 등을 설정할 수 있습니다.

아래 그림은 Cloudformation을 통해 설정된 Red Route Table에 2개의 VPC를 Attachment를 통해 연결한 것입니다. AOCTANK,BOCTANK VPC가 연결되어 있습니다.

![](../.gitbook/assets/tgw_route_table2.png)

Transit Gateway에 연결되면, 그룹화된 Route Table에 다른 VPC Routing Table을 선택적으로 전파할 수 있습니다. Red Route Table에는 아래와 같이 ITOCTANK,AOCTANK,BOCTANK Table등 3개의 VPC 네트워크을 전파합니다.

![](../.gitbook/assets/tgw_route_table3%20%281%29.png)

TGW Route Table에서는 Static Route와 Blackhole Route를 처리할 수 있습니다.  
Cloudformation을 통해 구성한 아래 Red Route Table에서는 0.0.0.0/0 \(Default Route\)에 대해서 모두 ITOCTANK VPC로 향하게 구성되어 있습니다.

![](../.gitbook/assets/tgw_route_table4.png)

### 

### 각 VPC에서 EC2 통신 확



